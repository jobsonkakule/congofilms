{% extends "base.html.twig" %}

{% block title post.title %}

{% block metadata %}

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@bouclierjoseph">
    <meta name="twitter:author" content="@jobkakule2">
    <meta name="twitter:title" content="{{ post.title }}">
    <meta name="twitter:description" content="{{ post.content | striptags | truncate(100) }}">
    {% if post.pictures is not empty %}
        <meta name="twitter:image" content="{{ vich_uploader_asset(post.pictures[0], 'imageFile') | imagine_filter('thumb') }}">
    {% else %}
        <meta name="twitter:image" content="{{ '/images/logo.png'| imagine_filter('thumb') }}">
    {% endif %}
    

    <meta property="og:site_name" content="grandslacsnews.com">
    <meta property="og:title" content="{{ post.title }}">
    <meta property="og:description" content="{{ post.content | striptags | truncate(100) }}">
    <meta property="og:type" content="article">
    <meta property="og:article:published_time" content="{{ post.createdAt | date("d F, Y") }}">
    <meta property="og:article:author" content="{{ post.author.username }}">
    <meta property="og:article:section" content="Blog">
    <meta property="og:article:tag" content="{{ post.category.title }}">
    <meta property="og:url" content="{{ path('post.show', {id: post.id, slug: post.slug}) }}">
    <meta property="og:language" content="fr">
    <meta property="og:created_time" content="{{ post.createdAt | date("d F, Y") }}">
    {% if post.pictures is not empty %}
        <meta property="og:image" content="{{ vich_uploader_asset(post.pictures[0], 'imageFile') | imagine_filter('thumb')  }}">
    {% else %}
        <meta property="og:image" content="{{ '/images/logo.png'| imagine_filter('thumb') }}">
    {% endif %}

{% endblock %}
    
{% block body %}
    <div class="container">
        <div class="crumb">
            <span>
            <a href="{{ path('home') }}">Accueil</a>
            </span>
            {% if post.category %}
                <i class="fas fa-chevron-right"></i>
                <span>
                    <a href="{{ path('category.show', {id: post.category.id, slug: post.category.slug}) }}">{{ post.category.title }}</a>
                </span>
            {% endif %}
            {% if post.tags | length > 0 %}
                <i class="fas fa-chevron-right"></i>
                <span>
                    <a href="{{ path('post.index') }}?tag={{ post.tags[0] }}">{{ post.tags[0] }}</a>
                </span>
            {% endif %}
            <i class="fas fa-chevron-right"></i>
            <span>
            <a>{{ post.title }}</a>
            </span>
        </div>
        <div class="row">
            <div class="col-md-8">
            <div class="post-header">
                <ul class="category">
                    <li><a href="{{ path('category.show', {id: post.category.id, slug: post.category.slug}) }}">{{ post.category.title }}</a></li>
                    {% if post.tags | length > 0 %}
                        <li>
                            <a href="{{ path('post.index') }}?tag={{ post.tags[0] }}">{{ post.tags[0] }}</a>
                        </li>
                    {% endif %}
                </ul>
                <div class="post-title">
                    <h1>{{ post.title }}</h1>
                    <div class="post-info">
                        <div class="post-author">
                            Par 
                            <a href="{{ path('profil.show', {id: post.author.id}) }}">
                                {% if post.author.pseudo is not null %}
                                    {{ post.author.pseudo }}
                                {% else %}
                                    {{ post.author.username }}
                                {% endif %}
                            </a> 
                            - 
                        </div>
                        {#<span class="post-date">{{ post.createdAt | date("d F, Y") }}</span>#}
                        <span class="post-date">{{ post.createdAt | localizeddate('long', 'short') }}</span>
                        <div class="post-stat">
                        <a href="#comments" title="Commentaires">
                            <i class="fas fa-comments"></i>
                            {{ post.comments | length }}
                        </a>
                        </div>
                        <div class="post-stat">
                        <i class="fas fa-eye" title="Vues"></i>
                        {{ post.views }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="sharing-post">
                <span><i class="fas fa-share-alt"></i></span>
                <a href="" class="share_facebook">
                    <div class="share-icon">
                        <i class="fab fa-facebook-f"></i>
                    </div>
                    <div class="share-text">
                        Facebook
                    </div>
                </a>
                <a href="" class="share_twitter">
                    <div class="share-icon" style="background: #29c5f6">
                        <i class="fab fa-twitter"></i>
                    </div>
                    <div class="share-text" style="background: #29c5f6">
                        Twitter
                    </div>
                </a>
                <a href="" class="share_whatsapp">
                    <div class="share-icon" style="background: #7bbf6a">
                        <i class="fab fa-whatsapp"></i>
                    </div>
                    <div class="share-text" style="background: #7bbf6a">
                        Whatsapp
                    </div>
                </a>
                {% if is_granted('ROLE_EDITOR') %}
                    <a href="{{ path('admin.post.edit', {id: post.id}) }}" class="float-right" title="Editer l'article">
                        <span>
                            <i class="fas fa-edit"></i>
                        </span>
                    </a>
                {% endif %}
            </div>
            <div class="post-content">
                <div data-slider class="post-featured-img">
                    {% if post.pictures is not empty %}
                        {% for picture in post.pictures %}
                            <img src="{{ vich_uploader_asset(picture, 'imageFile') }}" alt="" title="{{ post.title }}">
                        {% endfor %}
                    {% endif %}
                </div>
                <div>
                    {{ post.content | raw }}
                </div>
                <br>
                <ul class="td-tags">
                    {% if post.tags | length > 0 %}
                        <li style="display: inline;">
                            <span>TAGS</span>
                        </li>
                        {% for tag in post.tags %}
                            <li style="display: inline;">
                                <a href="{{ path('post.index') }}?tag={{ tag }}">{{ tag }}</a>
                            </li>
                        {% endfor %}
                    {% endif %}
                </ul>
                <hr>
                <div id="fb-root"></div>
                <div class="sharing-post sharing-bottom">
                    <div class="fb-like" data-href="{{ path('post.show', {id: post.id, slug: post.slug}) }}" data-width="" data-layout="button_count" data-action="like" data-size="small" data-share="false"></div>
                    &nbsp;
                    et
                    &nbsp;
                    <span><i class="fas fa-share-alt"></i></span>
                    <a href="">
                        <div class="share-icon">
                        <i class="fab fa-facebook-f"></i>
                        </div>
                    </a>
                    <a href="">
                        <div class="share-icon" style="background: #29c5f6">
                        <i class="fab fa-twitter"></i>
                        </div>
                    </a>
                    <a href="">
                        <div class="share-icon" style="background: #7bbf6a">
                        <i class="fab fa-whatsapp"></i>
                        </div>
                    </a>
                    ou
                    <a href="" class="post-comment">
                        <div class="share-icon" style="background: #1b2e3f; color:#FFF;">
                        <i class="far fa-comment"></i>
                        </div>
                    </a>
                </div>
                <hr>
                <div class="js-show">
                    <div class="cat-high-toggle js-show-title">
                        <h6>
                            <a href="{{ path('post.show', {id: post.id, slug: post.slug}) }}" class="toggle-item cat-high-selected">articles associ√©s</a>
                            <a href="?author={{ post.author.id }}" class="toggle-item">Plus de l'auteur</a>
                        </h6>
                    </div>
                    <div class="row last-articles js-show-content" style="position: relative;">
                        {% include "post/_associatedPosts.html.twig" %}
                    </div>
                    <br>
                    <div class="pagination justify-content-center js-show-pagination">
                        {% include "post/_postPagination.html.twig" %}
                    </div>
                </div>
                {% include "post/_form.html.twig" %}
            </div>
            </div>
            <div class="col-md-4 article-reminder">
                <div class="pub-1">
                    {{ pub() }}
                </div>
                <br>
                {{ sidebar() }}
            </div>
        </div>
        <br>
        <div class="pub-2">
            {{ topPub() }}
        </div>
    </div>
    <br>
{% endblock %}
{% block javascripts %}
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/fr_FR/sdk.js#xfbml=1&version=v5.0&appId=454671828554424&autoLogAppEvents=1"></script>
{% endblock %}